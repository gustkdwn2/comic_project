<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.comic.mapper.MemberMapper">
	
	<insert id="memberInsert">
		INSERT INTO COMIC_MEMBER(MEMBER_ID,MEMBER_PWD,MEMBER_NAME,MEMBER_EMAIL,MEMBER_PHONE_NUMBER) VALUES (#{MEMBER_ID},
		#{MEMBER_PWD}, #{MEMBER_NAME}, #{MEMBER_EMAIL},
		#{MEMBER_PHONE_NUMBER})
	</insert>
	
	<insert id="employeeInsert">
		INSERT INTO COMIC_EMPLOYEE VALUES ((SELECT NVL(MAX(EMPLOYEE_NUM),0)+1 FROM COMIC_EMPLOYEE),
		#{EMPLOYEE_PWD}, #{EMPLOYEE_NAME}, #{EMPLOYEE_PHONE}, #{EMPLOYEE_ACCOUNT}, SYSDATE, #{EMPLOYEE_POSITION}, #{EMPLOYEE_PAY})
	</insert>

	<select id="login" resultType="com.comic.model.MemberVO">
		SELECT * FROM COMIC_MEMBER WHERE MEMBER_ID = #{MEMBER_ID, jdbcType=VARCHAR}
	</select>
	
	<update id="keepLogin">
		UPDATE COMIC_MEMBER SET SESSION_KEY = #{sessionId},
		SESSION_LIMIT = #{sessionLimit} WHERE MEMBER_ID = #{MEMBER_ID}
	</update>
	
	<select id="checkUserWithSessionKey" resultType="com.comic.model.MemberVO">
		SELECT * FROM COMIC_MEMBER WHERE SESSION_KEY = #{value}
	</select>
	
</mapper>