<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.comic.mapper.OrderMapper">

	<insert id="orderInsert">
		insert into
		comic_orderview(orderview_num, orderview_category, orderview_product_num)
		values ((select max(orderview_num) from comic_orderview)+1, #{orderview_category}, #{orderview_product_num})
	</insert>
	
	<select id="orderSelect" resultType="com.comic.model.OrderViewVO">
		select * from COMIC_ORDERVIEW order by orderview_num 
	</select>
	
	<update id="orderUpdate">
		update comic_orderview set ORDERVIEW_CATEGORY = #{orderview_category} where ORDERVIEW_NUM = #{orderview_num}
	</update>

	<delete id="orderDelete">
		delete comic_orderview where orderview_num = #{number}
	</delete>
	
	<!-- 밑으로는 ajax 상품 등록 -->
	<resultMap type="com.comic.model.ProductVO" id="productVO">
		<result column="PRODUCT_NUM" property="product_num"/>
		<result column="PRODUCT_NAME" property="product_name"/>
		<result column="PRODUCT_PRICE" property="product_price"/>
		<result column="PRODUCT_QTY" property="product_qty"/>
		<result column="PRODUCT_CATEGORY" property="product_category"/>
	</resultMap>
	
	<resultMap type="com.comic.model.OrderProductViewVO" id="orderProductViewVO">
		<result column="ORDERVIEW_NUM" property="orderview_num"/>
		<result column="ORDERVIEW_CATEGORY_NUM" property="orderview_num"/>
		<result column="ORDERVIEW_NUM" property="orderview_num"/>
	</resultMap>
	
	<select id="orderProductSelect" resultType="com.comic.model.OrderProductViewVO">
		select
		    fk.PRODUCT_NAME,
		    fk.PRODUCT_PRICE
		from
		    COMIC_PRODUCTSTOCK fk, COMIC_ORDERVIEW_PRODUCT pk
		where
		    fk.PRODUCT_NUM = pk.orderview_product_num
		AND
		    pk.ORDERVIEW_CATEGORY = '음료류'
	</select>
</mapper>